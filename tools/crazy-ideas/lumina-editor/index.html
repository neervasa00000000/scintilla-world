<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lumina - Professional Image Editor</title>
  <link rel="icon" type="image/png" href="/assets/logo/favicon.png">
  <link rel="apple-touch-icon" href="/assets/logo/favicon.png">
  <link rel="shortcut icon" href="/assets/logo/favicon.png">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React and ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  
  <!-- Babel Standalone for JSX transformation -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // --- Icon Components (Lucide Icons as SVG) ---
    const Upload = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="17 8 12 3 7 8"></polyline>
        <line x1="12" y1="3" x2="12" y2="15"></line>
      </svg>
    );

    const Download = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
    );

    const RotateCcw = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <polyline points="1 4 1 10 7 10"></polyline>
        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
      </svg>
    );

    const Sliders = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <line x1="4" y1="21" x2="4" y2="14"></line>
        <line x1="4" y1="10" x2="4" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12" y2="3"></line>
        <line x1="20" y1="21" x2="20" y2="16"></line>
        <line x1="20" y1="12" x2="20" y2="3"></line>
        <line x1="1" y1="14" x2="7" y2="14"></line>
        <line x1="9" y1="8" x2="15" y2="8"></line>
        <line x1="17" y1="16" x2="23" y2="16"></line>
      </svg>
    );

    const ImageIcon = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        <circle cx="8.5" cy="8.5" r="1.5"></circle>
        <polyline points="21 15 16 10 5 21"></polyline>
      </svg>
    );

    const Layers = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
        <polyline points="2 17 12 22 22 17"></polyline>
        <polyline points="2 12 12 17 22 12"></polyline>
      </svg>
    );

    const Maximize = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
      </svg>
    );

    const Sun = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <circle cx="12" cy="12" r="5"></circle>
        <line x1="12" y1="1" x2="12" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="23"></line>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
        <line x1="1" y1="12" x2="3" y2="12"></line>
        <line x1="21" y1="12" x2="23" y2="12"></line>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
      </svg>
    );

    const Contrast = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M12 18a6 6 0 0 0 0-12v12z"></path>
      </svg>
    );

    const Droplet = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
      </svg>
    );

    const Aperture = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="14.31" y1="8" x2="20.05" y2="17.94"></line>
        <line x1="9.69" y1="8" x2="21.17" y2="8"></line>
        <line x1="7.38" y1="12" x2="13.12" y2="2.06"></line>
        <line x1="9.69" y1="16" x2="3.95" y2="6.06"></line>
        <line x1="14.31" y1="16" x2="2.83" y2="16"></line>
        <line x1="16.62" y1="12" x2="10.88" y2="21.94"></line>
      </svg>
    );

    const Palette = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <circle cx="13.5" cy="6.5" r=".5" fill="currentColor"></circle>
        <circle cx="17.5" cy="10.5" r=".5" fill="currentColor"></circle>
        <circle cx="8.5" cy="7.5" r=".5" fill="currentColor"></circle>
        <circle cx="6.5" cy="12.5" r=".5" fill="currentColor"></circle>
        <path d="M12 2C6.5 2 2 6.5 2 12c0 4.5 3.5 8 8 8 1.5 0 2.5-.5 3.5-1.5.5-.5 1-1.5 1-2.5v-1.5c0-1.5-1-2.5-2.5-2.5H9c-1.5 0-2.5-1-2.5-2.5V9c0-1.5 1-2.5 2.5-2.5h2.5c1.5 0 2.5-1 2.5-2.5V4.5c0-1.5-1-2.5-2.5-2.5z"></path>
      </svg>
    );

    const Undo = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <path d="M3 7v6h6"></path>
        <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>
      </svg>
    );

    const Wand2 = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <path d="M21.64 3.64l-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72z"></path>
        <path d="M14 7l3 3"></path>
        <path d="M5 6v4"></path>
        <path d="M19 14v4"></path>
        <path d="M10 2v4"></path>
        <path d="M7 8H3"></path>
        <path d="M21 16h-4"></path>
        <path d="M11 4H7"></path>
      </svg>
    );

    const Frame = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <line x1="22" y1="6" x2="2" y2="6"></line>
        <line x1="22" y1="18" x2="2" y2="18"></line>
        <line x1="6" y1="2" x2="6" y2="22"></line>
        <line x1="18" y1="2" x2="18" y2="22"></line>
      </svg>
    );

    const Check = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
    );

    const Move = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
        <polyline points="5 9 2 12 5 15"></polyline>
        <polyline points="9 5 12 2 15 5"></polyline>
        <polyline points="15 19 12 22 9 19"></polyline>
        <polyline points="19 9 22 12 19 15"></polyline>
        <line x1="2" y1="12" x2="22" y2="12"></line>
        <line x1="12" y1="2" x2="12" y2="22"></line>
      </svg>
    );

    // --- Default Settings & Constants ---
    const DEFAULT_SETTINGS = {
      brightness: 100,
      contrast: 100,
      saturation: 100,
      grayscale: 0,
      sepia: 0,
      hueRotate: 0,
      blur: 0,
      vignette: 0,
      red: 0,
      green: 0,
      blue: 0,
    };

    const TEMPLATES = [
      {
        id: 'normal',
        name: 'Normal',
        settings: { ...DEFAULT_SETTINGS }
      },
      {
        id: 'vintage',
        name: 'Vintage 1980',
        settings: { ...DEFAULT_SETTINGS, brightness: 110, contrast: 90, saturation: 80, sepia: 30, hueRotate: -10, red: 10, blue: -10 }
      },
      {
        id: 'golden',
        name: 'Golden Hour',
        settings: { ...DEFAULT_SETTINGS, sepia: 40, saturation: 130, brightness: 105, contrast: 105, red: 20, blue: -10 }
      },
      {
        id: 'polaroid',
        name: 'Polaroid',
        settings: { ...DEFAULT_SETTINGS, brightness: 120, contrast: 85, saturation: 90, sepia: 20, blur: 0 }
      },
      {
        id: 'noir',
        name: 'Cinema Noir',
        settings: { ...DEFAULT_SETTINGS, grayscale: 100, contrast: 120, brightness: 110 }
      },
      {
        id: 'matte_bw',
        name: 'Matte B&W',
        settings: { ...DEFAULT_SETTINGS, grayscale: 100, contrast: 90, brightness: 115 }
      },
      {
        id: 'dramatic',
        name: 'Dramatic',
        settings: { ...DEFAULT_SETTINGS, contrast: 130, saturation: 110, sepia: 20, brightness: 90, red: 15 }
      },
      {
        id: 'technicolor',
        name: 'Technicolor',
        settings: { ...DEFAULT_SETTINGS, saturation: 180, contrast: 115, brightness: 105, red: -10, blue: 10 }
      },
      {
        id: 'super_dreamy',
        name: 'Cloud 9',
        settings: { ...DEFAULT_SETTINGS, brightness: 110, contrast: 90, saturation: 85, blur: 0, sepia: 0, hueRotate: -15, red: -5, blue: 25 }
      },
      {
        id: 'calm',
        name: 'Serenity',
        settings: { ...DEFAULT_SETTINGS, brightness: 105, contrast: 95, saturation: 80, sepia: 0, hueRotate: -5, green: 5, blue: 30 }
      },
      {
        id: 'soft_glow',
        name: 'Soft Glow',
        settings: { ...DEFAULT_SETTINGS, brightness: 115, contrast: 85, saturation: 90, blur: 0, blue: 20, red: -10 }
      },
      {
        id: 'pop',
        name: 'Vivid Pop',
        settings: { ...DEFAULT_SETTINGS, contrast: 130, saturation: 160, brightness: 108, red: 10 }
      },
      {
        id: 'ocean_blue',
        name: 'Ocean Blue',
        settings: { ...DEFAULT_SETTINGS, saturation: 140, contrast: 110, hueRotate: -20, blue: 30, red: -10 }
      },
      {
        id: 'dreamy',
        name: 'Soft Dream',
        settings: { ...DEFAULT_SETTINGS, brightness: 115, contrast: 90, saturation: 110, blur: 0, blue: 5 }
      },
      {
        id: 'fade',
        name: 'Faded Film',
        settings: { ...DEFAULT_SETTINGS, brightness: 105, contrast: 85, saturation: 85, sepia: 15, green: 5 }
      },
    ];

    const FRAMES = [
      { id: 'none', name: 'None', color: 'transparent', width: 0 },
      { id: 'white', name: 'White', color: '#ffffff', width: 20 },
      { id: 'black', name: 'Black', color: '#1a1a1a', width: 20 },
      { id: 'film', name: 'Film', color: '#1a1a1a', width: 40, style: 'dashed' },
      { id: 'cream', name: 'Cream', color: '#f5f5f0', width: 30 },
    ];

    function LuminaEditor() {
      const [image, setImage] = useState(null);
      const [settings, setSettings] = useState(DEFAULT_SETTINGS);
      const [activeTab, setActiveTab] = useState('templates');
      const [selectedFrame, setSelectedFrame] = useState(FRAMES[0]);
      const [currentTemplateId, setCurrentTemplateId] = useState('normal');
      
      const fileInputRef = useRef(null);

      // --- Handlers ---
      const handleImageUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => setImage(event.target.result);
          reader.readAsDataURL(file);
        }
      };

      const loadDemoImage = () => {
        setImage("https://images.unsplash.com/photo-1472214103451-9374bd1c798e?q=80&w=2070&auto=format&fit=crop");
      };

      const updateSetting = (key, value) => {
        setSettings(prev => ({ ...prev, [key]: value }));
        setCurrentTemplateId('custom');
      };

      const applyTemplate = (template) => {
        setSettings(template.settings);
        setCurrentTemplateId(template.id);
      };

      const resetEdits = () => {
        setSettings(DEFAULT_SETTINGS);
        setSelectedFrame(FRAMES[0]);
        setCurrentTemplateId('normal');
      };

      // --- Image Processing & Download ---
      const getFilterString = () => {
        return `
          brightness(${settings.brightness}%) 
          contrast(${settings.contrast}%) 
          saturate(${settings.saturation}%) 
          grayscale(${settings.grayscale}%) 
          sepia(${settings.sepia}%) 
          hue-rotate(${settings.hueRotate}deg) 
          blur(${settings.blur}px)
        `;
      };

      const handleDownload = () => {
        if (!image) return;

        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        
        img.crossOrigin = "Anonymous";
        img.src = image;

        img.onload = () => {
          const frameWidth = selectedFrame.id !== 'none' ? (img.width * 0.05) : 0;
          
          canvas.width = img.width + (frameWidth * 2);
          canvas.height = img.height + (frameWidth * 2);

          if (selectedFrame.id !== 'none') {
            ctx.fillStyle = selectedFrame.color;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
          }

          ctx.filter = getFilterString();
          ctx.drawImage(img, frameWidth, frameWidth, img.width, img.height);
          ctx.filter = 'none';
          ctx.globalCompositeOperation = 'overlay';

          if (settings.red !== 0) {
            ctx.fillStyle = settings.red > 0 
              ? `rgba(255, 0, 0, ${settings.red / 100})`    
              : `rgba(0, 255, 255, ${Math.abs(settings.red) / 100})`;
            ctx.fillRect(frameWidth, frameWidth, img.width, img.height);
          }

          if (settings.green !== 0) {
            ctx.fillStyle = settings.green > 0 
              ? `rgba(0, 255, 0, ${settings.green / 100})`  
              : `rgba(255, 0, 255, ${Math.abs(settings.green) / 100})`;
            ctx.fillRect(frameWidth, frameWidth, img.width, img.height);
          }

          if (settings.blue !== 0) {
            ctx.fillStyle = settings.blue > 0 
              ? `rgba(0, 0, 255, ${settings.blue / 100})`   
              : `rgba(255, 255, 0, ${Math.abs(settings.blue) / 100})`;
            ctx.fillRect(frameWidth, frameWidth, img.width, img.height);
          }

          if (settings.vignette > 0) {
            ctx.globalCompositeOperation = 'source-over';
            const gradient = ctx.createRadialGradient(
              canvas.width / 2, canvas.height / 2, img.width * 0.3,
              canvas.width / 2, canvas.height / 2, img.width * 0.8
            );
            gradient.addColorStop(0, 'rgba(0,0,0,0)');
            gradient.addColorStop(1, `rgba(0,0,0,${settings.vignette})`);
            
            ctx.fillStyle = gradient;
            ctx.fillRect(frameWidth, frameWidth, img.width, img.height);
          }

          const link = document.createElement('a');
          link.download = 'lumina-edit.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
        };
      };

      // --- UI Components ---
      const Slider = ({ label, icon: Icon, value, min, max, onChange, unit = '', step = 1 }) => (
        <div className="mb-5 group">
          <div className="flex justify-between items-center mb-2">
            <div className="flex items-center text-gray-400 group-hover:text-white transition-colors">
              {Icon && <Icon size={14} className="mr-2" />}
              <span className="text-xs font-semibold tracking-wide uppercase">{label}</span>
            </div>
            <span className="text-xs text-gray-500 font-mono bg-neutral-800 px-2 py-0.5 rounded text-[10px]">{value}{unit}</span>
          </div>
          <div className="relative h-6 flex items-center">
            <div className="absolute w-full h-1 bg-neutral-800 rounded-full overflow-hidden">
              <div 
                className="h-full bg-indigo-500 transition-all duration-75 ease-out" 
                style={{ width: `${((value - min) / (max - min)) * 100}%` }}
              />
            </div>
            <input
              type="range"
              min={min}
              max={max}
              step={step}
              value={value}
              onChange={(e) => onChange(Number(e.target.value))}
              className="absolute w-full h-full opacity-0 cursor-pointer"
            />
            <div 
              className="absolute w-4 h-4 bg-white rounded-full shadow-lg border-2 border-indigo-500 pointer-events-none transition-all duration-75 ease-out"
              style={{ left: `calc(${((value - min) / (max - min)) * 100}% - 8px)` }}
            />
          </div>
        </div>
      );

      return (
        <div className="h-screen bg-neutral-950 text-gray-100 font-sans flex flex-col overflow-hidden selection:bg-indigo-500/30">
          
          {/* --- Modern Header --- */}
          <header className="h-16 px-6 flex items-center justify-between border-b border-white/5 bg-neutral-950/50 backdrop-blur-md z-30 sticky top-0">
            <div className="flex items-center space-x-3">
              <div className="w-9 h-9 bg-gradient-to-tr from-indigo-600 to-violet-600 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-500/20">
                <Aperture size={20} className="text-white" />
              </div>
              <span className="text-lg font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-white to-neutral-400">
                Lumina
              </span>
            </div>
            <div className="flex items-center gap-3">
              <input type="file" ref={fileInputRef} onChange={handleImageUpload} accept="image/*" className="hidden" />
              
              <button 
                onClick={() => fileInputRef.current?.click()}
                className="px-4 py-2 rounded-lg text-xs font-semibold text-neutral-300 hover:text-white hover:bg-white/5 transition-all flex items-center gap-2 border border-transparent hover:border-white/10"
              >
                <Upload size={14} />
                Import
              </button>
              <div className="h-6 w-px bg-white/10 mx-1"></div>
              <button 
                onClick={handleDownload}
                disabled={!image}
                className={`px-5 py-2 rounded-lg text-xs font-bold transition-all flex items-center gap-2 shadow-lg ${
                  image 
                    ? 'bg-white text-black hover:bg-neutral-200 hover:scale-105 active:scale-95 shadow-indigo-500/10' 
                    : 'bg-neutral-800 text-neutral-500 cursor-not-allowed'
                }`}
              >
                <Download size={14} />
                Export
              </button>
            </div>
          </header>

          {/* --- Main Workspace --- */}
          <main className="flex-1 flex overflow-hidden relative">
            
            {/* Left: Immersive Canvas */}
            <div className="flex-1 relative flex items-center justify-center p-8 bg-neutral-950 overflow-hidden">
              {/* Subtle Grid Pattern Background */}
              <div className="absolute inset-0 opacity-[0.03]" 
                   style={{ 
                     backgroundImage: 'radial-gradient(#ffffff 1px, transparent 1px)', 
                     backgroundSize: '24px 24px' 
                   }}>
              </div>
              {!image ? (
                <div className="relative z-10 flex flex-col items-center justify-center p-12 border border-white/5 bg-white/5 rounded-3xl backdrop-blur-sm animate-in fade-in zoom-in duration-500">
                  <div className="w-20 h-20 bg-gradient-to-br from-neutral-800 to-neutral-900 rounded-full flex items-center justify-center mb-6 shadow-inner border border-white/5">
                    <ImageIcon size={32} className="text-neutral-500" />
                  </div>
                  <h2 className="text-2xl font-bold text-white mb-2">Start Creating</h2>
                  <p className="text-neutral-400 text-sm mb-8 text-center max-w-[200px]">
                    Drop an image here or browse to begin editing.
                  </p>
                  <div className="flex gap-3">
                    <button 
                      onClick={() => fileInputRef.current?.click()}
                      className="px-6 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full text-sm font-medium transition-all shadow-lg shadow-indigo-900/30"
                    >
                      Open Image
                    </button>
                    <button 
                      onClick={loadDemoImage}
                      className="px-6 py-2.5 bg-neutral-800 hover:bg-neutral-700 text-neutral-200 rounded-full text-sm font-medium transition-all border border-white/5"
                    >
                      Try Demo
                    </button>
                  </div>
                </div>
              ) : (
                <div className="relative z-10 transition-all duration-300 ease-out max-h-full max-w-full flex items-center justify-center">
                  <div 
                    style={{
                      padding: `${selectedFrame.id !== 'none' ? '24px' : '0px'}`,
                      backgroundColor: selectedFrame.color,
                    }}
                    className="transition-all duration-300 ease-in-out shadow-2xl shadow-black/50 rounded-sm"
                  >
                    <div className="relative overflow-hidden group">
                      <img 
                        src={image} 
                        alt="Preview" 
                        className="max-h-[80vh] max-w-full object-contain block transition-all duration-200"
                        style={{
                          filter: getFilterString(),
                        }}
                      />
                      
                      {/* Color Overlay Simulations */}
                      {['red', 'green', 'blue'].map(channel => (
                         settings[channel] !== 0 && (
                          <div 
                            key={channel}
                            className="absolute inset-0 pointer-events-none mix-blend-overlay"
                            style={{ 
                              backgroundColor: 
                                channel === 'red' ? (settings.red > 0 ? 'red' : 'cyan') :
                                channel === 'green' ? (settings.green > 0 ? 'lime' : 'magenta') :
                                (settings.blue > 0 ? 'blue' : 'yellow'),
                              opacity: Math.abs(settings[channel]) / 100 
                            }} 
                          />
                         )
                      ))}
                      {/* Vignette Overlay */}
                      {settings.vignette > 0 && (
                        <div 
                          className="absolute inset-0 pointer-events-none"
                          style={{
                            background: `radial-gradient(circle, transparent 40%, rgba(0,0,0,${settings.vignette}) 100%)`
                          }}
                        />
                      )}
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* Right: Modern Floating Sidebar */}
            <aside className="w-80 bg-neutral-900/80 backdrop-blur-xl border-l border-white/5 flex flex-col shrink-0 z-20">
              
              {/* Segmented Control Tabs */}
              <div className="p-4 border-b border-white/5">
                <div className="flex bg-neutral-950/50 p-1 rounded-lg border border-white/5">
                  {[
                    { id: 'templates', icon: Wand2, label: 'Filters' },
                    { id: 'adjust', icon: Sliders, label: 'Adjust' },
                    { id: 'frames', icon: Frame, label: 'Frame' },
                  ].map(tab => (
                    <button
                      key={tab.id}
                      onClick={() => setActiveTab(tab.id)}
                      className={`flex-1 flex items-center justify-center py-2 text-xs font-medium rounded-md transition-all duration-200 ${
                        activeTab === tab.id 
                          ? 'bg-neutral-800 text-white shadow-sm' 
                          : 'text-neutral-500 hover:text-neutral-300'
                      }`}
                    >
                      <tab.icon size={14} className="mr-1.5" />
                      {tab.label}
                    </button>
                  ))}
                </div>
              </div>

              {/* Tools Area */}
              <div className="flex-1 overflow-y-auto px-5 py-6 scrollbar-thin scrollbar-thumb-neutral-700 scrollbar-track-transparent">
                
                {activeTab === 'templates' && (
                  <div className="space-y-6">
                    <div className="flex justify-between items-center">
                      <h3 className="text-xs font-bold text-neutral-400 uppercase tracking-wider">Style Library</h3>
                      {currentTemplateId !== 'normal' && (
                        <button onClick={resetEdits} className="text-[10px] text-indigo-400 hover:text-indigo-300 font-medium">Reset</button>
                      )}
                    </div>
                    
                    <div className="grid grid-cols-2 gap-3">
                      {TEMPLATES.map((t) => {
                        const isActive = currentTemplateId === t.id;
                        return (
                          <button
                            key={t.id}
                            onClick={() => applyTemplate(t)}
                            className={`group relative h-24 rounded-2xl overflow-hidden transition-all duration-300 border ${
                              isActive 
                                ? 'border-indigo-500 ring-2 ring-indigo-500/20 shadow-lg shadow-indigo-500/10 scale-[1.02]' 
                                : 'border-white/5 hover:border-white/20 hover:scale-[1.02]'
                            }`}
                          >
                            {/* Gradient Preview */}
                            <div className={`absolute inset-0 transition-opacity bg-gradient-to-br ${
                               t.id === 'normal' ? 'from-neutral-700 to-neutral-800' :
                               t.id === 'vintage' ? 'from-orange-900/80 to-yellow-900/80' :
                               t.id === 'golden' ? 'from-amber-600/80 to-orange-600/80' :
                               t.id === 'polaroid' ? 'from-yellow-200/50 to-neutral-300/50' :
                               t.id === 'noir' ? 'from-gray-900 to-black' :
                               t.id === 'matte_bw' ? 'from-neutral-500 to-neutral-700' :
                               t.id === 'dramatic' ? 'from-red-950 to-black' :
                               t.id === 'technicolor' ? 'from-emerald-600/80 to-blue-600/80' :
                               t.id === 'super_dreamy' ? 'from-cyan-300/60 to-blue-400/60' :
                               t.id === 'calm' ? 'from-blue-300/60 to-indigo-300/60' :
                               t.id === 'soft_glow' ? 'from-sky-200/50 to-cyan-200/50' :
                               t.id === 'pop' ? 'from-yellow-500/80 to-rose-500/80' :
                               t.id === 'ocean_blue' ? 'from-blue-600/80 to-cyan-500/80' :
                               t.id === 'dreamy' ? 'from-indigo-900/80 to-violet-800/80' :
                               'from-emerald-900/80 to-teal-900/80'
                            }`} />
                            
                            {/* Status Icon */}
                            {isActive && (
                               <div className="absolute top-2 right-2 w-5 h-5 bg-indigo-500 rounded-full flex items-center justify-center shadow-sm">
                                 <Check size={10} className="text-white" />
                               </div>
                            )}
                            <div className="absolute inset-0 p-3 flex flex-col justify-end">
                              <span className="font-semibold text-xs text-white drop-shadow-md">{t.name}</span>
                            </div>
                          </button>
                        )
                      })}
                    </div>
                  </div>
                )}

                {activeTab === 'adjust' && (
                  <div className="space-y-8 animate-in slide-in-from-right-2 duration-300">
                    
                    {/* Light Section */}
                    <div>
                      <h4 className="flex items-center text-xs font-bold text-neutral-400 uppercase tracking-wider mb-4">
                        <Sun size={12} className="mr-2" /> Light & Color
                      </h4>
                      <div className="space-y-1">
                        <Slider label="Exposure" icon={Sun} value={settings.brightness} min={0} max={200} onChange={(v) => updateSetting('brightness', v)} unit="%" />
                        <Slider label="Contrast" icon={Contrast} value={settings.contrast} min={0} max={200} onChange={(v) => updateSetting('contrast', v)} unit="%" />
                        <Slider label="Saturation" icon={Droplet} value={settings.saturation} min={0} max={200} onChange={(v) => updateSetting('saturation', v)} unit="%" />
                      </div>
                    </div>

                    {/* Effect Section */}
                    <div>
                      <h4 className="flex items-center text-xs font-bold text-neutral-400 uppercase tracking-wider mb-4">
                        <Aperture size={12} className="mr-2" /> Effects
                      </h4>
                      <div className="space-y-1">
                        <Slider label="Vignette" value={settings.vignette} min={0} max={1} step={0.1} onChange={(v) => updateSetting('vignette', v)} />
                        <Slider label="Blur" value={settings.blur} min={0} max={20} onChange={(v) => updateSetting('blur', v)} unit="px" />
                        <Slider label="Sepia" value={settings.sepia} min={0} max={100} onChange={(v) => updateSetting('sepia', v)} unit="%" />
                        <Slider label="B&W" value={settings.grayscale} min={0} max={100} onChange={(v) => updateSetting('grayscale', v)} unit="%" />
                      </div>
                    </div>

                    {/* Color Balance Section */}
                    <div>
                      <h4 className="flex items-center text-xs font-bold text-neutral-400 uppercase tracking-wider mb-4">
                        <Palette size={12} className="mr-2" /> Color Balance
                      </h4>
                      <div className="p-4 bg-neutral-950/30 rounded-xl border border-white/5 space-y-4">
                        <div className="flex items-center justify-between text-[10px] text-neutral-500 font-mono mb-2">
                          <span>CYAN/RED</span>
                          <span>MAGENTA/GREEN</span>
                          <span>YELLOW/BLUE</span>
                        </div>
                        
                        {/* RGB Sliders with custom gradients */}
                        <div className="relative h-2 rounded-full overflow-hidden bg-gradient-to-r from-cyan-500 via-neutral-600 to-red-500 mb-4">
                          <input type="range" min="-50" max="50" value={settings.red} onChange={(e) => updateSetting('red', Number(e.target.value))} className="w-full h-full opacity-0 cursor-pointer absolute z-10" />
                          <div className="absolute top-0 bottom-0 w-1 bg-white shadow-sm pointer-events-none" style={{ left: `${((settings.red + 50) / 100) * 100}%` }}></div>
                        </div>
                        <div className="relative h-2 rounded-full overflow-hidden bg-gradient-to-r from-fuchsia-500 via-neutral-600 to-green-500 mb-4">
                          <input type="range" min="-50" max="50" value={settings.green} onChange={(e) => updateSetting('green', Number(e.target.value))} className="w-full h-full opacity-0 cursor-pointer absolute z-10" />
                          <div className="absolute top-0 bottom-0 w-1 bg-white shadow-sm pointer-events-none" style={{ left: `${((settings.green + 50) / 100) * 100}%` }}></div>
                        </div>
                        <div className="relative h-2 rounded-full overflow-hidden bg-gradient-to-r from-yellow-400 via-neutral-600 to-blue-600">
                          <input type="range" min="-50" max="50" value={settings.blue} onChange={(e) => updateSetting('blue', Number(e.target.value))} className="w-full h-full opacity-0 cursor-pointer absolute z-10" />
                          <div className="absolute top-0 bottom-0 w-1 bg-white shadow-sm pointer-events-none" style={{ left: `${((settings.blue + 50) / 100) * 100}%` }}></div>
                        </div>
                        
                        <div className="pt-2">
                          <Slider label="Hue Tint" icon={RotateCcw} value={settings.hueRotate} min={-180} max={180} onChange={(v) => updateSetting('hueRotate', v)} unit="Â°" />
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {activeTab === 'frames' && (
                  <div className="space-y-4">
                    <div className="flex justify-between items-center mb-2">
                      <h3 className="text-xs font-bold text-neutral-400 uppercase tracking-wider">Frames</h3>
                    </div>
                    <div className="grid grid-cols-2 gap-3">
                      {FRAMES.map((f) => (
                        <button
                          key={f.id}
                          onClick={() => setSelectedFrame(f)}
                          className={`h-24 rounded-xl border flex flex-col items-center justify-center transition-all ${
                            selectedFrame.id === f.id 
                              ? 'border-indigo-500 bg-neutral-800' 
                              : 'border-white/10 hover:border-white/20 bg-neutral-900'
                          }`}
                        >
                          <div 
                            className="w-10 h-10 mb-2 shadow-sm"
                            style={{ 
                              border: f.id !== 'none' ? `4px ${f.style || 'solid'} ${f.color}` : '1px dashed #555',
                              backgroundColor: '#222'
                            }}
                          />
                          <span className="text-xs text-neutral-400 font-medium">{f.name}</span>
                        </button>
                      ))}
                    </div>
                  </div>
                )}
              </div>

              <div className="p-4 border-t border-white/5 text-[10px] text-neutral-600 text-center font-medium">
                LUMINA STUDIO v2.0
              </div>
            </aside>
          </main>
        </div>
      );
    }

    // Render the app
    ReactDOM.render(<LuminaEditor />, document.getElementById('root'));
  </script>
</body>
</html>

